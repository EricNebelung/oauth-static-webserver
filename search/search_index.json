{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#welcome-to-oauth-static-webserver","title":"Welcome to OAuth Static Webserver","text":"<p>Disclaimer: This project is currently in an early development stage and is only intended for testing and educational purposes. It is not yet production-ready.</p> <p>The OAuth Static Webserver is designed to serve static web content while providing protection trough OpenID Connect (OIDC) authentication and authorization. It can serve multiple sites with different configurations (e.g. different OIDC providers or access rules) simultaneously. The main goals of this project are the ease of use and simple configuration while providing decent level of security and logging.</p> <p>To getting started, please refer to the Installation and Configuration documentation.</p>"},{"location":"configuration/","title":"Configuration","text":"<p>The configuration of the OAuth Static Webserver is split into two main parts:</p> <ul> <li>Server Configuration to set up the server environment and session management.</li> <li>Site Configuration to define the static sites to be served and their respective OIDC protection settings.</li> </ul>"},{"location":"configuration/#server-configuration","title":"Server Configuration","text":"<p>The server configuration is done with environment variables.</p> Field Default Description <code>LOG_LEVEL</code> <code>info</code> The logging level like <code>debug</code>, <code>info</code>, <code>warn</code> or <code>error</code> <code>CONFIG_PATH</code> <code>/etc/oauth-static-webserver/config.yaml</code> The path to the configuration file. <code>HOST_ADDRESS</code> <code>HOST_PORT</code> <code>8080</code> The http(s) listen port. <code>HTTP2_MAX_CONCURRENT_STREAMS</code> <code>100</code> <code>HTTP2_MAX_READ_FRAME_SIZE</code> <code>1048576</code> (1 KiB) <code>HTTP2_IDLE_TIMEOUT</code> <code>10</code> (Seconds) <code>TLS_ENABLED</code> <code>false</code> Enables the TLS functionality of the server. <code>TLS_HTTP_REDIRECT</code> <code>true</code> Force HTTPS instead of HTTP <code>TLS_CERT_FILE</code> The path to the TLS certificate file. <code>TLS_KEY_FILE</code> The path to the TLS key file. <code>TLS_AUTO_TLS</code> <code>false</code> To use automatic TLS certificate request (Let's Encrypt) <code>TLS_AUTO_TLS_CERT_CACHE_DIR</code> Uses a tmp directory, when no path is provided. The cert cache dir, required to prevent Let's Encrypt rate limiting. <code>SESSION_KEY</code> Session Encryption Key, should be a secret. <code>SESSION_STORE_DRIVER</code> <code>filesystem</code> The session storage. Use <code>redis</code> to use a Redis DB. <code>SESSION_STORE_DIRECTORY</code> Path to the session storage (only required when <code>filesystem</code> is used) <code>SESSION_REDIS_ADDRESS</code> The Address of the redis server <code>SESSION_REDIS_PORT</code> <code>6379</code> The Port of the redis server <code>SESSION_REDIS_USERNAME</code> Username for the authentication <code>SESSION_REDIS_PASSWORD</code> Password for the authentication <code>SESSION_REDIS_DB</code> <code>0</code> Redis DB Index <code>SESSION_REDIS_POOL_SIZE</code> <code>10</code> Connection pool size for the Redis DB"},{"location":"configuration/#site-configuration","title":"Site Configuration","text":"<p>The site configuration is done with a YAML configuration file.</p> <pre><code>oidc:\n  # Base URL for callback (and more) - must accessible from the internet\n  # often the reverse proxy\n  base_url: \"http://localhost:8080/\"\n  providers:\n    - id: idp\n      config_url: \"[WELL-KNOWN-URL]\"\n      client_id: \"[CLIENT_ID]\"\n      client_secret: \"[CLIENT_SECRET_KEY]\"\nstatic_pages:\n  - id: page1\n    dir: \"page1\"\n    url: \"/static/page1\"\n  - id: page2\n    dir: \"/var/www/page2\"\n    url: \"/static/page2\"\n    protection:\n      provider: idp\n      expression: \"text.has_prefix(user.email, '@example.com') || user.level &gt;= 3\"\n      groups:\n        - group1\n        - group2 \n</code></pre> <p>The example above shows the basic structure of the configuration file with all existing options.</p> <p>Some explanations about the fields:</p> <ul> <li><code>oidc.base_url</code>: The base URL where the server is reachable from the internet. This is often the URL of the reverse proxy in front of the server.</li> <li><code>oidc.providers</code>: A list of OIDC providers to use for authentication.</li> <li><code>id</code>: A unique identifier for the provider.</li> <li><code>config_url</code>: The well-known URL of the OIDC provider.</li> <li><code>client_id</code>: The client ID for the OIDC application.</li> <li><code>client_secret</code>: The client secret for the OIDC application.</li> <li><code>static_pages</code>: A list of static pages to be served.</li> <li><code>id</code>: A unique identifier for the static page (used for logging).</li> <li><code>dir</code>: The directory where the static content is located.</li> <li><code>url</code>: The URL path where the static content will be accessible.</li> <li><code>protection</code>: (Optional) The protection settings for the static page.<ul> <li><code>provider</code>: The <code>id</code> of the OIDC provider to use for authentication.</li> <li><code>groups</code>: (Optional) A list of groups that are allowed to access the static page. If not specified, the group check is skipped.</li> <li><code>expression</code>: (Optional) A custom expression to evaluate for access control. The expression can use user attributes like <code>user.email</code>, <code>user.level</code>, etc.</li> </ul> </li> </ul> <p>The <code>protection</code> section is optional. If it is not provided, the static page will be publicly accessible without authentication. Also, both <code>groups</code> and <code>expression</code> are optional inside the <code>protection</code>. The expression will be evaluated first and then the group check.</p> <p>The expression language is a fully featured programming language, but here it will be inserted into a boolean context.  The language named \"tengo\" is documented here: https://github.com/d5/tengo/</p> <p>Also for the expression context, the following stdlib modules are available:</p> <ul> <li><code>text</code>: https://github.com/d5/tengo/blob/master/docs/stdlib-text.md</li> <li><code>math</code>: https://github.com/d5/tengo/blob/master/docs/stdlib-math.md</li> <li><code>times</code>: https://github.com/d5/tengo/blob/master/docs/stdlib-times.md</li> </ul> <p>To use it, write the name first and then call the methods, e.g. <code>text.has_prefix(user.email, '@example.com')</code>. All user attributes are available via the <code>user</code> variable, e.g. <code>user.email</code>, <code>user.name</code>, <code>user.level</code>, etc.</p>"},{"location":"installation/","title":"Installation","text":"<p>Currently, there are two installation methods:</p> <ul> <li>manual installation</li> <li>using Docker</li> </ul> <p>The usage of Docker is recommended and a prebuild image is provided via the Github Container Registry.</p>"},{"location":"installation/#docker","title":"Docker","text":"<p>Requirements:</p> <ul> <li>Docker with support for Docker Compose installed (or an alternative like Podman with Compose support)</li> <li>Knowledge of how to use Docker Compose</li> <li>Internet access to pull the image</li> </ul> <p>You can pull the latest image from the Github Container Registry with the following command: </p><pre><code>docker pull ghcr.io/ericnebelung/oauth-static-webserver:latest\n</code></pre> With the following compose file you can start the service: <pre><code>networks:\n  oauth-static-webserver:\n    external: false\n\nservices:\n  oauth-static-webserver:\n    image: ghcr.io/ericnebelung/oauth-static-webserver:latest\n    restart: always\n    environment:\n      - SESSION_KEY=some_secret_key\n      - SESSION_STORE_DRIVER=redis\n      - SESSION_REDIS_ADDRESS=session-storage\n      - SESSION_REDIS_PORT=6379\n    ports:\n      - \"8080:8080\"\n    networks:\n      - oauth-static-webserver\n    volumes:\n      - \"/etc/oauth-resource-proxy/config.yaml:/etc/oauth-resource-proxy/config.yaml:ro\"\n      - \"/var/www:/var/www:ro\"\n    depends_on:\n      - session-storage\n  session-storage:\n    image: redis:latest\n    restart: always\n    networks:\n      - oauth-static-webserver\n    volumes:\n      - cache:/data\n\nvolumes:\n  cache:\n    driver: local\n</code></pre><p></p> <p>You must adjust some parameters like the <code>SESSION_KEY</code> and the volume mounts for your configuration file and static web content. The <code>/var/www</code> are the default root directory for the static web content, which is also set as working directory in the image. You can also add extra volume mounts and simply set the paths in the configuration file.</p> <p>For more details about the configuration, please refer to the Configuration documentation.</p>"},{"location":"installation/#manual","title":"Manual","text":"<p>You can also build the project manually. The following requirements must be fulfilled:</p> <ul> <li>Go 1.24 or higher (only tested with Go 1.24 on Linux)</li> <li>Git (to clone the repository)</li> <li>Internet access to download dependencies</li> </ul> <p>To build the project, follow these steps:</p> <ol> <li>Clone the repository:    <pre><code>git clone https://github.com/EricNebelung/oauth-static-webserver\n</code></pre></li> <li>Change into the project directory:    <pre><code>cd oauth-static-webserver\n</code></pre></li> <li>Build the project using Go:    <pre><code>go build -o oauth-static-webserver\n</code></pre></li> <li>Add the executable permission to the binary:    <pre><code>chmod +x oauth-static-webserver\n</code></pre></li> </ol> <p>Now an executable binary named <code>oauth-static-webserver</code> should be available in the project directory. From here, you can deploy and run the binary as needed.</p> <p>The programm does not use any command line argument yet, but all configuration is done via environment variables and a configuration file. For more details about the configuration, please refer to the Configuration documentation.</p>"}]}